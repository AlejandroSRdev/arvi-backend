ARQUITECTURA HEXAGONAL - ÃRBOL DE ESTRUCTURA CREADO
====================================================

stripe_backend/
â”‚
â”œâ”€â”€ ğŸ“„ server.js                              âœ… Backend original (FUNCIONAL)
â”œâ”€â”€ ğŸ“„ server-hexagonal.js                    ğŸ†• Nuevo entrypoint (vacÃ­o)
â”‚
â”œâ”€â”€ ğŸ“ src/                                   âœ… Backend original (39 archivos - NO MODIFICADO)
â”‚   â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ controllers/
â”‚   â”œâ”€â”€ middleware/
â”‚   â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ services/
â”‚   â””â”€â”€ utils/
â”‚
â”œâ”€â”€ ğŸ“ domain/                                ğŸ†• NÃšCLEO DE NEGOCIO (18 archivos)
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ entities/                          (5 archivos - Entidades puras)
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ User.js                        âšª TODO: LÃ³gica de validaciÃ³n de User
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ Energy.js                      âšª TODO: CÃ¡lculos y reglas de energÃ­a
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ Trial.js                       âšª TODO: Reglas de trial (48h)
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ Subscription.js                âšª TODO: Estados de suscripciÃ³n
â”‚   â”‚   â””â”€â”€ ğŸ“„ Plan.js                        âšª TODO: Entidad Plan
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ policies/                          (3 archivos - Reglas de negocio)
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ PlanPolicy.js                  âšª TODO: Mover src/config/plans.js
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ ModelSelectionPolicy.js        âšª TODO: Mover src/config/modelMapping.js
â”‚   â”‚   â””â”€â”€ ğŸ“„ EnergyPolicy.js                âšª TODO: PolÃ­ticas de energÃ­a
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ use-cases/                         (5 archivos - Casos de uso)
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ GenerateAIResponse.js          âšª TODO: LÃ³gica de generaciÃ³n IA
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ ConsumeEnergy.js               âšª TODO: LÃ³gica de consumo
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ ValidatePlanAccess.js          âšª TODO: ValidaciÃ³n de acceso
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ ActivateTrial.js               âšª TODO: ActivaciÃ³n de trial
â”‚   â”‚   â””â”€â”€ ï¿½ï¿½ ProcessSubscription.js         âšª TODO: Procesamiento de suscripciones
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ ports/                             (4 archivos - Interfaces/Contratos)
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ IAIProvider.js                 âšª TODO: Interface para proveedores IA
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ IUserRepository.js             âšª TODO: Interface repositorio usuarios
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ IEnergyRepository.js           âšª TODO: Interface repositorio energÃ­a
â”‚   â”‚   â””â”€â”€ ğŸ“„ IPaymentProvider.js            âšª TODO: Interface proveedores pago
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ validators/                        (1 archivo - Validadores)
â”‚       â””â”€â”€ ğŸ“„ InputValidator.js              âšª TODO: Mover src/utils/validator.js
â”‚
â”œâ”€â”€ ğŸ“ infrastructure/                        ğŸ†• ADAPTADORES (29 archivos)
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ ai/                                (4 archivos - Proveedores IA)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ openai/
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ OpenAIConfig.js            âšª TODO: Mover src/config/openai.js
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ OpenAIAdapter.js           âšª TODO: Implementar IAIProvider
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ğŸ“ gemini/
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ GeminiConfig.js            âšª TODO: Mover src/config/gemini.js
â”‚   â”‚       â””â”€â”€ ğŸ“„ GeminiAdapter.js           âšª TODO: Implementar IAIProvider
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ persistence/                       (5 archivos - Persistencia)
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ğŸ“ firestore/
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ FirebaseConfig.js          âšª TODO: Mover src/config/firebase.js
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ FirestoreUserRepository.js âšª TODO: CRUD usuarios
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ FirestoreEnergyRepository.js âšª TODO: Operaciones energÃ­a
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ FirestoreTrialRepository.js  âšª TODO: Operaciones trial
â”‚   â”‚       â””â”€â”€ ğŸ“„ FirestoreSubscriptionRepository.js âšª TODO: Operaciones suscripciones
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ payment/                           (2 archivos - Pagos)
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ğŸ“ stripe/
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ StripeConfig.js            âšª TODO: Mover src/config/stripe.js
â”‚   â”‚       â””â”€â”€ ğŸ“„ StripeAdapter.js           âšª TODO: Implementar IPaymentProvider
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ http/                              (20 archivos - Capa HTTP)
â”‚       â”‚
â”‚       â”œâ”€â”€ ğŸ“ middleware/                    (7 archivos)
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ authenticate.js            âšª TODO: Mover src/middleware/auth.js
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ authorizeFeature.js        âšª TODO: Mover src/middleware/authorizeFeature.js
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ validateEnergy.js          âšª TODO: Mover src/middleware/validateEnergy.js
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ validatePlanLimit.js       âšª TODO: Mover src/middleware/validatePlanLimit.js
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ validateInputSize.js       âšª TODO: Mover src/middleware/validateInputSize.js
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ rateLimiter.js             âšª TODO: Mover src/middleware/rateLimiter.js
â”‚       â”‚   â””â”€â”€ ğŸ“„ errorHandler.js            âšª TODO: Mover src/middleware/errorHandler.js
â”‚       â”‚
â”‚       â”œâ”€â”€ ğŸ“ controllers/                   (5 archivos)
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ AIController.js            âšª TODO: Mover src/controllers/aiController.js
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ AuthController.js          âšª TODO: Mover src/controllers/authController.js
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ EnergyController.js        âšª TODO: Mover src/controllers/energyController.js
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ UserController.js          âšª TODO: Mover src/controllers/userController.js
â”‚       â”‚   â””â”€â”€ ğŸ“„ WebhookController.js       âšª TODO: Mover src/controllers/webhookController.js
â”‚       â”‚
â”‚       â””â”€â”€ ğŸ“ routes/                        (6 archivos)
â”‚           â”œâ”€â”€ ğŸ“„ ai.routes.js               âšª TODO: Mover src/routes/ai.routes.js
â”‚           â”œâ”€â”€ ğŸ“„ auth.routes.js             âšª TODO: Mover src/routes/auth.routes.js
â”‚           â”œâ”€â”€ ğŸ“„ energy.routes.js           âšª TODO: Mover src/routes/energy.routes.js
â”‚           â”œâ”€â”€ ğŸ“„ user.routes.js             âšª TODO: Mover src/routes/user.routes.js
â”‚           â”œâ”€â”€ ğŸ“„ stripe.routes.js           âšª TODO: Mover src/routes/stripe.routes.js
â”‚           â””â”€â”€ ğŸ“„ webhook.routes.js          âšª TODO: Mover src/routes/webhook.routes.js
â”‚
â”œâ”€â”€ ğŸ“ shared/                                ğŸ†• COMPARTIDO (3 archivos)
â”‚   â”œâ”€â”€ ğŸ“„ constants.js                       âšª TODO: Mover src/utils/constants.js
â”‚   â”œâ”€â”€ ğŸ“„ errorTypes.js                      âšª TODO: Mover src/utils/errorTypes.js
â”‚   â””â”€â”€ ğŸ“„ logger.js                          âšª TODO: Mover src/utils/logger.js
â”‚
â””â”€â”€ ğŸ“„ DOCUMENTACIÃ“N CREADA
    â”œâ”€â”€ ARQUITECTURA_HEXAGONAL_PLAN.md        âœ… AnÃ¡lisis y plan detallado
    â”œâ”€â”€ ARQUITECTURA_HEXAGONAL_README.md      âœ… GuÃ­a de la estructura
    â”œâ”€â”€ ESTRUCTURA_HEXAGONAL_COMPLETADA.md    âœ… Resumen ejecutivo
    â””â”€â”€ ARBOL_ESTRUCTURA.txt                  âœ… Este archivo


LEYENDA:
========

âœ… = Archivo/carpeta del backend original (NO modificado)
ğŸ†• = Archivo/carpeta nueva (arquitectura hexagonal)
âšª = Archivo vacÃ­o con TODO (listo para migraciÃ³n)
ğŸ“„ = Archivo
ğŸ“ = Carpeta


ESTADÃSTICAS:
=============

Total archivos creados:        51
â”œâ”€ domain/                     18 archivos
â”œâ”€ infrastructure/             29 archivos
â””â”€ shared/                      3 archivos

Archivos backend original:     39 archivos (intactos)
Documentos creados:             4 archivos


PRÃ“XIMOS PASOS:
===============

1. Revisar ARQUITECTURA_HEXAGONAL_README.md
2. Empezar migraciÃ³n por archivos simples (shared/, policies/)
3. Continuar con HTTP layer (middleware, controllers, routes)
4. Dividir archivos complejos (models, services)
5. Probar con server-hexagonal.js


FECHA DE CREACIÃ“N: 2025-12-28
CREADO POR: Claude Code (Arquitecto de Software)
